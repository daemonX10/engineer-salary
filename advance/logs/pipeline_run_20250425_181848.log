2025-04-25 18:18:48,325 - INFO - --- Starting Complete Pipeline Run --- Timestamp: 20250425_181848 ---
2025-04-25 18:18:48,325 - INFO - Pipeline Config: Combined FE, Scaling=True, FeatSelect=True (Thresh=mean), CV Thresh=0.72, n_jobs=16 used, Class Weights Enabled, Const Cols Kept
2025-04-25 18:18:48,327 - INFO - Logging detailed output to: logs/pipeline_run_20250425_181848.log
2025-04-25 18:18:48,327 - INFO - Loading data...
2025-04-25 18:18:48,402 - INFO - Train shape: (1280, 317), Test shape: (854, 316)
2025-04-25 18:18:48,409 - INFO - Found 39 unique states and 5 unique feature_1 values.
2025-04-25 18:18:48,409 - INFO - Preprocessing training data (using combined logic)...
2025-04-25 18:18:48,409 - INFO - Starting preprocessing (Combined Logic). Is training: True
2025-04-25 18:18:48,413 - INFO - Target 'salary_category' label encoded.
2025-04-25 18:18:48,415 - INFO - Saved label encoder and mapping.
2025-04-25 18:18:48,415 - INFO - Initial cleaning: Numerical and Boolean Features...
2025-04-25 18:18:48,492 - WARNING - Col 'feature_10' has non-0/1 vals (834). Treat as numeric, impute median.
2025-04-25 18:18:48,494 - INFO - Starting Feature Engineering...
2025-04-25 18:18:48,501 - INFO - Fit/saved TE for job_title_grouped
2025-04-25 18:18:48,518 - INFO - Processed 'job_title'.
2025-04-25 18:18:48,519 - INFO - Processed 'job_posted_date'.
2025-04-25 18:18:48,530 - INFO - Added bin f9.
2025-04-25 18:18:48,531 - INFO - Added: feature_2_9_interaction
2025-04-25 18:18:48,534 - INFO - Added transforms f2 (sq, sqrt, bin).
2025-04-25 18:18:48,536 - INFO - Added bool aggs.
2025-04-25 18:18:48,537 - INFO - Added: feature_10_8_interaction
2025-04-25 18:18:48,539 - INFO - Added new interactions: ['feat2_job_title_encoded', 'feat2_boolsum', 'feat2_recency', 'job_title_encoded_recency']
2025-04-25 18:18:48,607 - INFO - Applying PCA (n=15) to job desc...
2025-04-25 18:18:48,643 - INFO - Fit/saved PCA.
2025-04-25 18:18:48,648 - INFO - Finished job desc features.
2025-04-25 18:18:48,649 - INFO - Applying manual OHE for 'job_state' (39 unique).
2025-04-25 18:18:48,651 - INFO - Applying manual OHE for 'feature_1' (5 unique).
2025-04-25 18:18:48,662 - INFO - Final cleanup and column alignment...
2025-04-25 18:18:48,671 - WARNING - Col 'is_senior' constant (nunique=1) in train. Engineered: True. Keeping col.
2025-04-25 18:18:48,672 - WARNING - Col 'is_junior' constant (nunique=1) in train. Engineered: True. Keeping col.
2025-04-25 18:18:48,673 - WARNING - Col 'is_developer' constant (nunique=1) in train. Engineered: True. Keeping col.
2025-04-25 18:18:48,673 - WARNING - Col 'is_specialist' constant (nunique=1) in train. Engineered: True. Keeping col.
2025-04-25 18:18:48,674 - INFO - Eng col 'feature_9_bin' low card (nunique=2) in train.
2025-04-25 18:18:48,676 - INFO - Eng col 'state_NM' low card (nunique=2) in train.
2025-04-25 18:18:48,676 - INFO - Eng col 'state_DC' low card (nunique=2) in train.
2025-04-25 18:18:48,677 - INFO - Eng col 'state_IA' low card (nunique=2) in train.
2025-04-25 18:18:48,677 - INFO - Eng col 'state_AK' low card (nunique=2) in train.
2025-04-25 18:18:48,677 - INFO - Eng col 'state_OR' low card (nunique=2) in train.
2025-04-25 18:18:48,678 - INFO - Eng col 'state_MD' low card (nunique=2) in train.
2025-04-25 18:18:48,678 - INFO - Eng col 'state_TX' low card (nunique=2) in train.
2025-04-25 18:18:48,679 - WARNING - Col 'state_KS' constant (nunique=1) in train. Engineered: True. Keeping col.
2025-04-25 18:18:48,679 - INFO - Eng col 'state_NJ' low card (nunique=2) in train.
2025-04-25 18:18:48,681 - WARNING - Col 'state_WY' constant (nunique=1) in train. Engineered: True. Keeping col.
2025-04-25 18:18:48,681 - INFO - Eng col 'state_VA' low card (nunique=2) in train.
2025-04-25 18:18:48,682 - INFO - Eng col 'state_AR' low card (nunique=2) in train.
2025-04-25 18:18:48,682 - INFO - Eng col 'state_SC' low card (nunique=2) in train.
2025-04-25 18:18:48,683 - INFO - Eng col 'state_UT' low card (nunique=2) in train.
2025-04-25 18:18:48,683 - INFO - Eng col 'state_CT' low card (nunique=2) in train.
2025-04-25 18:18:48,684 - INFO - Eng col 'state_GA' low card (nunique=2) in train.
2025-04-25 18:18:48,684 - INFO - Eng col 'state_NC' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_MN' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_IL' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_MO' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_LA' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_PA' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_OH' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_SD' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - WARNING - Col 'state_RI' constant (nunique=1) in train. Engineered: True. Keeping col.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_NV' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_AL' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_OK' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_IN' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_AZ' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_KY' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_FL' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_MI' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_CA' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_NY' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_TN' low card (nunique=2) in train.
2025-04-25 18:18:48,685 - INFO - Eng col 'state_MA' low card (nunique=2) in train.
2025-04-25 18:18:48,696 - INFO - Eng col 'state_WA' low card (nunique=2) in train.
2025-04-25 18:18:48,697 - INFO - Eng col 'state_CO' low card (nunique=2) in train.
2025-04-25 18:18:48,697 - INFO - Eng col 'feat1_A' low card (nunique=2) in train.
2025-04-25 18:18:48,698 - INFO - Eng col 'feat1_B' low card (nunique=2) in train.
2025-04-25 18:18:48,698 - INFO - Eng col 'feat1_D' low card (nunique=2) in train.
2025-04-25 18:18:48,699 - INFO - Eng col 'feat1_C' low card (nunique=2) in train.
2025-04-25 18:18:48,699 - INFO - Eng col 'feat1_E' low card (nunique=2) in train.
2025-04-25 18:18:48,700 - INFO - Saved 100 feature names (const cols NOT dropped).
2025-04-25 18:18:48,702 - INFO - Preprocessing train done. Shape: (1280, 100). Time: 0.29s
2025-04-25 18:18:48,706 - INFO - Train preprocess done. Initial Feats: 100
2025-04-25 18:18:48,706 - INFO - Splitting data (80/20)...
2025-04-25 18:18:48,710 - INFO - Train (Pre-scale): (1024, 100), Val (Pre-scale): (256, 100)
2025-04-25 18:18:48,711 - INFO - Applying StandardScaler...
2025-04-25 18:18:48,718 - INFO - Scaler saved: scalers/scaler_20250425_181848.joblib
2025-04-25 18:18:48,718 - INFO - Preprocessing test data (using combined logic)...
2025-04-25 18:18:48,718 - INFO - Starting preprocessing (Combined Logic). Is training: False
2025-04-25 18:18:48,718 - INFO - Loaded LE: label_encoder_20250425_181848.joblib
2025-04-25 18:18:48,718 - INFO - Initial cleaning: Numerical and Boolean Features...
2025-04-25 18:18:48,784 - WARNING - Col 'feature_10' has non-0/1 vals (540). Treat as numeric, impute median.
2025-04-25 18:18:48,786 - INFO - Starting Feature Engineering...
2025-04-25 18:18:48,793 - INFO - Loaded TE: features/job_title_encoder_20250425_181848.joblib
2025-04-25 18:18:48,797 - INFO - Processed 'job_title'.
2025-04-25 18:18:48,797 - INFO - Processed 'job_posted_date'.
2025-04-25 18:18:48,797 - INFO - Added bin f9.
2025-04-25 18:18:48,797 - INFO - Added: feature_2_9_interaction
2025-04-25 18:18:48,797 - INFO - Added transforms f2 (sq, sqrt, bin).
2025-04-25 18:18:48,811 - INFO - Added bool aggs.
2025-04-25 18:18:48,811 - INFO - Added: feature_10_8_interaction
2025-04-25 18:18:48,814 - INFO - Added new interactions: ['feat2_job_title_encoded', 'feat2_boolsum', 'feat2_recency', 'job_title_encoded_recency']
2025-04-25 18:18:48,847 - INFO - Applying PCA (n=15) to job desc...
2025-04-25 18:18:48,864 - INFO - Loaded PCA: features/job_desc_pca_20250425_181848.joblib
2025-04-25 18:18:48,864 - INFO - Finished job desc features.
2025-04-25 18:18:48,880 - INFO - Applying manual OHE for 'job_state' (39 unique).
2025-04-25 18:18:48,880 - INFO - Applying manual OHE for 'feature_1' (5 unique).
2025-04-25 18:18:48,880 - INFO - Final cleanup and column alignment...
2025-04-25 18:18:48,899 - INFO - Preprocessing test done. Shape: (854, 100). Time: 0.18s
2025-04-25 18:18:48,899 - INFO - Test columns aligned.
2025-04-25 18:18:48,899 - INFO - Scaling test data...
2025-04-25 18:18:48,914 - INFO - Test preprocess & scale done. Shape: (854, 100)
2025-04-25 18:18:48,915 - INFO - Performing feature selection (Threshold: mean)...
2025-04-25 18:18:48,917 - INFO - Fitting RF for feature selection...
2025-04-25 18:18:49,117 - INFO - Feat selection removed 61 features. Selected 39.
2025-04-25 18:18:49,117 - INFO - Selection applied to train/val/test partitions.
2025-04-25 18:18:49,117 - INFO - Data shapes post-scaling/selection: Train=(1024, 39), Val=(256, 39), Test=(854, 39)
2025-04-25 18:18:49,117 - INFO - Number of features used in modeling: 39
2025-04-25 18:18:49,117 - INFO - --- Optimizing models (Class Weights Enabled Where Applicable) ---
2025-04-25 18:18:49,117 - INFO - Minimum CV score threshold for qualification: 0.72
2025-04-25 18:18:49,117 - INFO - Optimization Order: ['logistic', 'knn', 'adaboost', 'randomforest', 'extratrees', 'gradientboosting', 'mlp', 'keras_mlp', 'catboost', 'xgboost', 'lightgbm']
2025-04-25 18:18:49,117 - INFO - --- Optimizing logistic (30 trials) ---
2025-04-25 18:18:49,117 - INFO - Starting logistic optimization (30 trials)...
2025-04-25 18:18:49,117 - INFO - Optuna timeout for logistic: 3600s.
2025-04-25 18:18:49,596 - INFO - Setting Optuna timeout 3600s.
2025-04-25 18:29:58,274 - INFO - Opt complete logistic. Best CV score: 0.66698. Best params: {'class_weight': {'0': 1.4, '1': 1.0, '2': 1.4}, 'penalty': 'l1', 'C': 280.64049788313935, 'max_iter': 555}
2025-04-25 18:29:58,274 - INFO - Saved Optuna summary: optuna_trials/logistic_study_summary_20250425_181848.txt
2025-04-25 18:29:58,274 - INFO - Instantiating final logistic model...
2025-04-25 18:29:58,274 - INFO - Converted LogReg class_weight keys to int: {0: 1.4, 1: 1.0, 2: 1.4}
2025-04-25 18:29:58,282 - INFO - LogReg final model using class_weight={'0': 1.4, '1': 1.0, '2': 1.4}
2025-04-25 18:29:58,282 - INFO - Fitting final logistic model...
2025-04-25 18:29:58,285 - ERROR - Error during final fit for logistic: The classes, [0, 1, 2], are not in class_weight
Traceback (most recent call last):
  File "C:\Users\damod\AppData\Local\Temp\ipykernel_3184\2112995697.py", line 696, in optimize_model
    final_model.fit(X, y)  # Fit standard models
    ^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\linear_model\_logistic.py", line 1276, in fit
    self.coef_, self.intercept_, self.n_iter_ = _fit_liblinear(
                                                ^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\svm\_base.py", line 1193, in _fit_liblinear
    class_weight_ = compute_class_weight(class_weight, classes=classes_, y=y)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\utils\_param_validation.py", line 189, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\utils\class_weight.py", line 87, in compute_class_weight
    raise ValueError(
ValueError: The classes, [0, 1, 2], are not in class_weight
2025-04-25 18:29:58,285 - INFO - Qualification Check for logistic: final_model exists? False, best_cv_score=0.6669775, threshold=0.72, comparison result: False
2025-04-25 18:29:58,285 - INFO - --- NOT QUALIFIED: logistic (CV Score: 0.66698  - Final model fit/save failed) ---
2025-04-25 18:29:58,285 - INFO - --- Optimizing knn (25 trials) ---
2025-04-25 18:29:58,285 - INFO - Starting knn optimization (25 trials)...
2025-04-25 18:29:58,285 - INFO - Optuna timeout for knn: 3600s.
2025-04-25 18:29:58,495 - INFO - Setting Optuna timeout 3600s.
2025-04-25 18:30:04,080 - INFO - Opt complete knn. Best CV score: 0.69338. Best params: {'metric': 'manhattan', 'n_neighbors': 27, 'weights': 'distance', 'leaf_size': 27, 'algorithm': 'auto'}
2025-04-25 18:30:04,082 - INFO - Saved Optuna summary: optuna_trials/knn_study_summary_20250425_181848.txt
2025-04-25 18:30:04,084 - INFO - Instantiating final knn model...
2025-04-25 18:30:04,084 - INFO - KNN final model - balancing requires SMOTE or different approach (not applied in final fit here).
2025-04-25 18:30:04,084 - INFO - Fitting final knn model...
2025-04-25 18:30:04,086 - INFO - Final knn fitted in 0.00s.
2025-04-25 18:30:04,086 - INFO - Saving final knn model...
2025-04-25 18:30:04,089 - INFO - Saved final knn via joblib: models/knn_20250425_181848.joblib
2025-04-25 18:30:04,090 - INFO - Saving importance knn...
2025-04-25 18:30:04,090 - INFO - Model knn (KNeighborsClassifier) lacks standard importance attributes (feature_importances_, coef_, relevant estimator_).
2025-04-25 18:30:04,091 - INFO - Qualification Check for knn: final_model exists? True, best_cv_score=0.6933764, threshold=0.72, comparison result: False
2025-04-25 18:30:04,091 - INFO - --- NOT QUALIFIED: knn (CV Score: 0.69338 ) ---
2025-04-25 18:30:04,092 - INFO - --- Optimizing adaboost (30 trials) ---
2025-04-25 18:30:04,092 - INFO - Starting adaboost optimization (30 trials)...
2025-04-25 18:30:04,093 - INFO - Optuna timeout for adaboost: 3600s.
2025-04-25 18:30:04,284 - INFO - Setting Optuna timeout 3600s.
2025-04-25 18:34:42,122 - INFO - Opt complete adaboost. Best CV score: 0.72264. Best params: {'base_estimator_max_depth': 4, 'class_weight_choice': 'balanced', 'n_estimators': 300, 'learning_rate': 0.8758299467250618}
2025-04-25 18:34:42,123 - INFO - Saved Optuna summary: optuna_trials/adaboost_study_summary_20250425_181848.txt
2025-04-25 18:34:42,124 - INFO - Instantiating final adaboost model...
2025-04-25 18:34:42,124 - INFO - Reconstruct AdaBoost DT(max_depth=4, class_weight=balanced) using SAMME
2025-04-25 18:34:42,125 - INFO - Fitting final adaboost model...
2025-04-25 18:34:45,612 - INFO - Final adaboost fitted in 3.49s.
2025-04-25 18:34:45,612 - INFO - Saving final adaboost model...
2025-04-25 18:34:45,667 - INFO - Saved final adaboost via joblib: models/adaboost_20250425_181848.joblib
2025-04-25 18:34:45,668 - INFO - Attempting calibration for adaboost...
2025-04-25 18:34:53,089 - INFO - Saved calibrated model: calibrated_models/adaboost_calibrated_20250425_181848.joblib
2025-04-25 18:34:53,090 - INFO - Saving importance adaboost...
2025-04-25 18:34:53,466 - INFO - Saved importance plot: plots\adaboost_feature_importance_20250425_181848.png
2025-04-25 18:34:53,469 - INFO - Saved importance csv: results\adaboost_feature_importance_20250425_181848.csv
2025-04-25 18:34:53,470 - INFO - Qualification Check for adaboost: final_model exists? True, best_cv_score=0.7226399, threshold=0.72, comparison result: True
2025-04-25 18:34:53,471 - INFO - +++ QUALIFIED: adaboost (CV Score: 0.72264)
2025-04-25 18:34:53,472 - INFO - Evaluating model 'adaboost_qualified_holdout_eval'...
2025-04-25 18:34:53,523 - INFO - Evaluation Results for 'adaboost_qualified_holdout_eval':
2025-04-25 18:34:53,524 - INFO -   Accuracy: 0.77344
2025-04-25 18:34:53,530 - INFO - Saved evaluation summary: results\adaboost_qualified_holdout_eval_evaluation_20250425_181848.txt
2025-04-25 18:34:53,621 - INFO - Saved confusion matrix plot: plots\adaboost_qualified_holdout_eval_confusion_matrix_20250425_181848.png
2025-04-25 18:34:53,622 - INFO - Hold-out Acc (adaboost): 0.77344
2025-04-25 18:34:53,623 - INFO - --- Generating individual predictions for adaboost ---
2025-04-25 18:34:53,624 - INFO - Generating test predictions using adaboost_qual_individual_pred...
2025-04-25 18:34:53,663 - INFO - Saved submission: submissions\solution_adaboost_qual_individual_pred_20250425_181848.csv
2025-04-25 18:34:53,665 - INFO - Test prediction distribution for 'adaboost_qual_individual_pred': {'Medium': 317, 'High': 273, 'Low': 264}
2025-04-25 18:34:53,665 - INFO - Saved test prediction summary: results\adaboost_qual_individual_pred_test_prediction_summary_20250425_181848.txt
2025-04-25 18:34:53,666 - INFO - Individual prediction file saved for adaboost.
2025-04-25 18:34:53,666 - INFO - --- Optimizing randomforest (40 trials) ---
2025-04-25 18:34:53,666 - INFO - Starting randomforest optimization (40 trials)...
2025-04-25 18:34:53,668 - INFO - Optuna timeout for randomforest: 7200s.
2025-04-25 18:34:53,851 - INFO - Setting Optuna timeout 7200s.
2025-04-25 18:42:42,523 - INFO - Opt complete randomforest. Best CV score: 0.72558. Best params: {'class_weight': {'0': 1.5, '1': 1.0, '2': 1.5}, 'n_estimators': 1300, 'max_depth': 42, 'min_samples_split': 6, 'min_samples_leaf': 1, 'max_features': 0.7, 'criterion': 'gini'}
2025-04-25 18:42:42,523 - INFO - Saved Optuna summary: optuna_trials/randomforest_study_summary_20250425_181848.txt
2025-04-25 18:42:42,523 - INFO - Instantiating final randomforest model...
2025-04-25 18:42:42,523 - INFO - Converted RF class_weight keys to int: {0: 1.5, 1: 1.0, 2: 1.5}
2025-04-25 18:42:42,523 - INFO - RF final model using class_weight={'0': 1.5, '1': 1.0, '2': 1.5}
2025-04-25 18:42:42,523 - INFO - Fitting final randomforest model...
2025-04-25 18:42:42,523 - ERROR - Error during final fit for randomforest: The classes, [0, 1, 2], are not in class_weight
Traceback (most recent call last):
  File "C:\Users\damod\AppData\Local\Temp\ipykernel_3184\2112995697.py", line 696, in optimize_model
    final_model.fit(X, y)  # Fit standard models
    ^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\ensemble\_forest.py", line 419, in fit
    y, expanded_class_weight = self._validate_y_class_weight(y)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\ensemble\_forest.py", line 879, in _validate_y_class_weight
    expanded_class_weight = compute_sample_weight(class_weight, y_original)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\utils\_param_validation.py", line 189, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\utils\class_weight.py", line 206, in compute_sample_weight
    weight_k = compute_class_weight(
               ^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\utils\_param_validation.py", line 189, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "d:\competition\engineer salary\advance\superNova\Lib\site-packages\sklearn\utils\class_weight.py", line 87, in compute_class_weight
    raise ValueError(
ValueError: The classes, [0, 1, 2], are not in class_weight
2025-04-25 18:42:42,531 - INFO - Qualification Check for randomforest: final_model exists? False, best_cv_score=0.7255763, threshold=0.72, comparison result: True
2025-04-25 18:42:42,532 - INFO - --- NOT QUALIFIED: randomforest (CV Score: 0.72558  - Final model fit/save failed) ---
2025-04-25 18:42:42,533 - INFO - --- Optimizing extratrees (40 trials) ---
2025-04-25 18:42:42,533 - INFO - Starting extratrees optimization (40 trials)...
2025-04-25 18:42:42,534 - INFO - Optuna timeout for extratrees: 7200s.
2025-04-25 18:42:42,723 - INFO - Setting Optuna timeout 7200s.
2025-04-25 18:45:08,259 - INFO - Opt complete extratrees. Best CV score: 0.72558. Best params: {'class_weight': 'balanced_subsample', 'n_estimators': 1500, 'max_depth': 30, 'min_samples_split': 7, 'min_samples_leaf': 1, 'max_features': 0.7, 'bootstrap': True, 'criterion': 'gini'}
2025-04-25 18:45:08,259 - INFO - Saved Optuna summary: optuna_trials/extratrees_study_summary_20250425_181848.txt
2025-04-25 18:45:08,259 - INFO - Instantiating final extratrees model...
2025-04-25 18:45:08,259 - INFO - ET final model using class_weight=balanced_subsample
2025-04-25 18:45:08,272 - INFO - Fitting final extratrees model...
2025-04-25 18:45:10,246 - INFO - Final extratrees fitted in 1.97s.
2025-04-25 18:45:10,247 - INFO - Saving final extratrees model...
2025-04-25 18:45:10,591 - INFO - Saved final extratrees via joblib: models/extratrees_20250425_181848.joblib
2025-04-25 18:45:10,591 - INFO - Attempting calibration for extratrees...
2025-04-25 18:45:16,883 - INFO - Saved calibrated model: calibrated_models/extratrees_calibrated_20250425_181848.joblib
2025-04-25 18:45:16,883 - INFO - Saving importance extratrees...
2025-04-25 18:45:17,339 - INFO - Saved importance plot: plots\extratrees_feature_importance_20250425_181848.png
2025-04-25 18:45:17,355 - INFO - Saved importance csv: results\extratrees_feature_importance_20250425_181848.csv
2025-04-25 18:45:17,356 - INFO - Qualification Check for extratrees: final_model exists? True, best_cv_score=0.7255811, threshold=0.72, comparison result: True
2025-04-25 18:45:17,356 - INFO - +++ QUALIFIED: extratrees (CV Score: 0.72558)
2025-04-25 18:45:17,356 - INFO - Evaluating model 'extratrees_qualified_holdout_eval'...
2025-04-25 18:45:17,528 - INFO - Evaluation Results for 'extratrees_qualified_holdout_eval':
2025-04-25 18:45:17,528 - INFO -   Accuracy: 0.75391
2025-04-25 18:45:17,539 - INFO - Saved evaluation summary: results\extratrees_qualified_holdout_eval_evaluation_20250425_181848.txt
2025-04-25 18:45:17,630 - INFO - Saved confusion matrix plot: plots\extratrees_qualified_holdout_eval_confusion_matrix_20250425_181848.png
2025-04-25 18:45:17,631 - INFO - Hold-out Acc (extratrees): 0.75391
2025-04-25 18:45:17,632 - INFO - --- Generating individual predictions for extratrees ---
2025-04-25 18:45:17,633 - INFO - Generating test predictions using extratrees_qual_individual_pred...
2025-04-25 18:45:17,808 - INFO - Saved submission: submissions\solution_extratrees_qual_individual_pred_20250425_181848.csv
2025-04-25 18:45:17,808 - INFO - Test prediction distribution for 'extratrees_qual_individual_pred': {'High': 348, 'Medium': 278, 'Low': 228}
2025-04-25 18:45:17,808 - INFO - Saved test prediction summary: results\extratrees_qual_individual_pred_test_prediction_summary_20250425_181848.txt
2025-04-25 18:45:17,808 - INFO - Individual prediction file saved for extratrees.
2025-04-25 18:45:17,808 - INFO - --- Optimizing gradientboosting (40 trials) ---
2025-04-25 18:45:17,808 - INFO - Starting gradientboosting optimization (40 trials)...
2025-04-25 18:45:17,808 - INFO - Optuna timeout for gradientboosting: 7200s.
2025-04-25 18:45:17,956 - INFO - Setting Optuna timeout 7200s.
